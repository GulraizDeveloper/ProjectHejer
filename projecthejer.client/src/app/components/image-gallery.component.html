<div class="image-gallery">
  <h4>Images ({{ images.length }}/10)</h4>
  
  <!-- Enhanced Upload Section -->
  <div 
    class="upload-section" 
    *ngIf="remainingSlots > 0"
    [class.dragover]="isDragOver"
    (dragover)="onDragOver($event)"
    (dragleave)="onDragLeave($event)"
    (drop)="onDrop($event)"
  >
    <div class="upload-content">
      <svg class="upload-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
        <polyline points="7,10 12,15 17,10"/>
        <line x1="12" y1="15" x2="12" y2="3"/>
      </svg>
      
      <h3 class="upload-title">Drop images here or click to browse</h3>
      <p class="upload-subtitle">Support for JPG, PNG, GIF up to 5MB each</p>
      
      <div class="upload-actions">
        <button 
          type="button"
          class="upload-btn" 
          (click)="fileInput.click()"
          [disabled]="uploading"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          {{ uploading ? 'Uploading...' : 'Choose Files' }}
        </button>
        
        <button 
          *ngIf="selectedFiles.length > 0"
          type="button"
          class="upload-btn" 
          (click)="uploadSelectedFiles()" 
          [disabled]="uploading"
        >
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20,6 9,17 4,12"/>
          </svg>
          Upload {{ selectedFiles.length }} file{{ selectedFiles.length > 1 ? 's' : '' }}
        </button>
      </div>
      
      <div class="remaining-slots">
        {{ remainingSlots }} slot{{ remainingSlots === 1 ? '' : 's' }} remaining
      </div>
    </div>
    
    <input 
      #fileInput
      type="file" 
      class="upload-input"
      multiple 
      accept="image/*" 
      (change)="onFileSelected($event)"
    >
  </div>

  <!-- Upload Message -->
  <div *ngIf="uploadMessage" class="upload-message" [ngClass]="uploadSuccess ? 'success' : 'error'">
    <svg *ngIf="uploadSuccess" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; margin-right: 8px; vertical-align: top;">
      <polyline points="20,6 9,17 4,12"/>
    </svg>
    <svg *ngIf="!uploadSuccess" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; margin-right: 8px; vertical-align: top;">
      <circle cx="12" cy="12" r="10"/>
      <line x1="15" y1="9" x2="9" y2="15"/>
      <line x1="9" y1="9" x2="15" y2="15"/>
    </svg>
    {{ uploadMessage }}
  </div>

  <!-- Advanced Image Grid -->
  <div class="images-container" *ngIf="images.length > 0">
    <div *ngFor="let image of images; let i = index; trackBy: trackByImageId" class="image-item">
      <div class="image-wrapper">
        <img 
          [src]="'data:' + (image.contentType || 'image/jpeg') + ';base64,' + image.imageData" 
          [alt]="image.fileName || 'Image ' + (i + 1)"
          (click)="showImageModal(image)"
          loading="lazy"
        >
        
        <div class="image-overlay">
          <div class="image-overlay-content">
            <h4 class="image-overlay-title">{{ image.fileName || 'Image ' + (i + 1) }}</h4>
            <p class="image-overlay-size">{{ formatFileSize(image.fileSize) }}</p>
          </div>
        </div>
      </div>
      
      <div class="image-info">
        <h4 class="image-filename">{{ image.fileName || 'Image ' + (i + 1) }}</h4>
        
        <div class="image-meta">
          <span class="image-size">{{ formatFileSize(image.fileSize) }}</span>
          <span class="image-date">{{ image.uploadedDate | date:'short' }}</span>
        </div>
        
        <div class="image-actions">
          <button 
            type="button"
            class="btn-icon btn-view" 
            (click)="showImageModal(image)"
            title="View full size"
            aria-label="View full size image"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
              <circle cx="12" cy="12" r="3"/>
            </svg>
          </button>
          
          <button 
            type="button"
            class="btn-icon btn-delete" 
            (click)="confirmDeleteImage(image)"
            [disabled]="deleting"
            title="Delete image"
            aria-label="Delete image"
          >
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <polyline points="3,6 5,6 21,6"/>
              <path d="m19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"/>
            </svg>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Enhanced No Images State -->
  <div *ngIf="images.length === 0" class="no-images">
    <svg class="no-images-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
      <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/>
      <circle cx="9" cy="9" r="2"/>
      <path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>
    </svg>
    <h4>No images uploaded yet</h4>
    <p>Start by uploading your first image. You can add up to 10 images with drag & drop or by clicking the upload button above.</p>
  </div>
</div>
